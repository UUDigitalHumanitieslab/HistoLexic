<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
</head>
<script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="http://cdn.jsdelivr.net/qtip2/2.2.1/jquery.qtip.js"></script>
<link rel="stylesheet" type="text/css" href="http://cdn.jsdelivr.net/qtip2/2.2.1/jquery.qtip.css">
<script>

$(document).ready(function() 
{
	// Wrap each word in a span tag
	$('p').each(function() {
		var text = [];
		// Split on each space
		$.each($(this).text().split(' '), function (i, v) {
			// Only wrap "words" in span tags, if there's a number in the word, don't wrap. 
			if (!/\d+/g.test(v)) {
				// Don't include non alphanumeric characters from the span tag. 
				var m = v.match(/[^A-Za-z\u00C0-\u017F]*$/); 
				text[i] = '<span>' + v.substring(0, m.index) + '</span>' + v.substring(m.index, v.length);
			}
			else {
				text[i] = v; 
			} 
		});
		$(this).html(text.join(' '));
	});
	 
	// Add a qtip tooltip to each word
	$('span').qtip({
		content: {
			text: function(event, api) {
				// Convert the word to lowercase for lookup
				var word = $(this).text().toLowerCase(); 
				
				// Try fetching the data from the INL LexiconService with an AJAX request
				$.ajax({
					// We do this via a CORS proxy, as the server has no 'Access-Control-Allow-Origin' setting
					url: 'http://www.corsproxy.com/sk.taalbanknederlands.inl.nl/LexiconService/lexicon/get_lemma',
					dataType: 'json',
					data: {
						database: 'lexicon_service_db',
						wordform: word,
						//pos: 'NOU',
						//year_from: 1890,
						//year_to: 2000,
					}, 
				})
				.then(function(response) {
					// On success, set the titleText content upon successful retrieval
					var titleText = '';
					var found = response.lemmata_list[0].found_lemmata; 
					$.each(found, function(index, value) { 
						titleText += value.lemma + ' (' + value.pos + ')'; 
						titleText += '<br>';
					});
					// If we found no results, set a basic titleText
					if (found.length === 0)
					{
						titleText = 'Geen lemmata gevonden'; 
					} 
					api.set('content.title', 'Lemmata voor <em>' + word + '</em>');
					api.set('content.text', titleText);
				}, function(xhr, status, error) {
					// On failure, set the tooltip content to the status and error value
					api.set('content.text', status + ': ' + error);
				});

				// Initial text while we wait for the AJAX request to complete
				return 'Ophalen...'; 
			}
		}
	});
});
</script>
<body>
<h1>HistoLexic example</h1>
<p>
De Nederlandsche Visscherij centrale wist mede, dat haar kantoor met Ingang van Dinsdag 14 April is verplaatst van Juliana van StoL bergplein 3-4, telefoonnummer 720080, intercommunaal, naar 2e Adelheidstraat 300 te s-Gravenhage, telefoonnummer 771800.
</p>
<p>
De afdeeling distributie en vischvervoer, telefoonnummer 720060,, toestel 674 en 722641 en de afdeeling garnalen, telefoonnummer 720060, toestel 790. zijn tot nadere aankondiging gevestigd aan den Bezuidenhoutscheweg 58 te s-Gravenhage
</p>
<p>
Verder zal de Nederlandsche Visscherijcentrale voortaan weer op Maandag en Zaterdag op de gewone uren geopend zijn.
</p>
</body>
</html>